{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://quantumpoly.ai/schemas/feedback-entry.schema.json",
  "title": "Feedback Entry Schema",
  "description": "Schema for structured ethical feedback synthesis entries integrated with governance ledger",
  "type": "object",
  "required": [
    "id",
    "cycleId",
    "timestamp",
    "category",
    "priority",
    "finding",
    "status"
  ],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^feedback-\\d{4}-\\d{2}-\\d{2}-\\d{3}$",
      "description": "Unique identifier in format: feedback-YYYY-MM-DD-NNN",
      "examples": ["feedback-2025-10-25-001"]
    },
    "cycleId": {
      "type": "string",
      "pattern": "^\\d{4}-Q[1-4]-[a-z0-9-]+$",
      "description": "Review cycle reference identifier",
      "examples": ["2025-Q4-validation"]
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 UTC timestamp of finding creation"
    },
    "category": {
      "type": "string",
      "enum": ["Technical", "Ethical", "Communication"],
      "description": "Primary categorization of the finding"
    },
    "priority": {
      "type": "string",
      "enum": ["P0", "P1", "P2", "P3"],
      "description": "Priority level: P0 (Critical), P1 (High), P2 (Medium), P3 (Low)"
    },
    "finding": {
      "type": "object",
      "required": ["description", "evidence", "impact"],
      "properties": {
        "description": {
          "type": "string",
          "minLength": 10,
          "maxLength": 2000,
          "description": "Clear, evidence-based description of the finding"
        },
        "evidence": {
          "type": "string",
          "minLength": 5,
          "maxLength": 500,
          "description": "Reference to evidence (file:line, URL, test result)",
          "examples": ["AUDIT_OF_INTEGRITY_REPORT.md:460-496"]
        },
        "impact": {
          "type": "string",
          "minLength": 10,
          "maxLength": 1000,
          "description": "Assessment of impact on stakeholders, compliance, or ethics"
        }
      },
      "additionalProperties": false
    },
    "actionItem": {
      "type": "object",
      "required": ["description", "owner", "status"],
      "properties": {
        "description": {
          "type": "string",
          "minLength": 10,
          "maxLength": 1000,
          "description": "Specific, actionable remediation or improvement step"
        },
        "owner": {
          "type": "string",
          "minLength": 3,
          "maxLength": 200,
          "description": "Team or individual responsible for action (with contact)",
          "examples": ["Legal Team <legal@quantumpoly.ai>"]
        },
        "dueDate": {
          "type": "string",
          "format": "date",
          "description": "Target completion date (ISO 8601 date format)"
        },
        "status": {
          "type": "string",
          "enum": ["Open", "In Progress", "Resolved", "Deferred"],
          "description": "Current status of the action item"
        }
      },
      "additionalProperties": false
    },
    "governanceLinks": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 3,
        "maxLength": 100
      },
      "description": "References to related governance ledger entry IDs",
      "examples": [["block7-baseline", "feedback-2025-Q4-validation"]]
    },
    "reviewerAnonymized": {
      "type": "boolean",
      "default": false,
      "description": "Whether the reviewer identity is anonymized for confidentiality"
    },
    "status": {
      "type": "string",
      "enum": ["Open", "In Progress", "Resolved", "Deferred", "Archived"],
      "description": "Overall status of the feedback finding"
    },
    "hash": {
      "type": "string",
      "pattern": "^[a-f0-9]{64}$",
      "description": "SHA256 hash of entry content for integrity verification"
    },
    "signature": {
      "type": ["string", "null"],
      "description": "GPG signature of the entry (null if Block 8 signing not operational)"
    },
    "metadata": {
      "type": "object",
      "properties": {
        "createdBy": {
          "type": "string",
          "description": "System or role that created the entry"
        },
        "lastModified": {
          "type": "string",
          "format": "date-time",
          "description": "Last modification timestamp"
        },
        "reviewedBy": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "List of reviewers who validated the entry"
        }
      }
    }
  },
  "additionalProperties": false
}

